window.ThreeMice=window.ThreeMice||{},ThreeMice.Events={MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSECLICK:"mouseclick"},ThreeMice.Options={callbackType:"function"},ThreeMice.log=function(a){console.log("ThreeMice: "+a)},ThreeMice.hasEvent=function(a,b){var c=!1;return a&&typeof a[b]===ThreeMice.Options.callbackType&&(c=!0),c},ThreeMice.Mouse=function(a){function b(a){if(a){if(a.renderer){o.renderer=a.renderer;var b=o.renderer.domElement.parentNode;b&&(o.container=b,o.offset=o.container.getBoundingClientRect(),o.size=o.renderer.getSize())}a.camera&&(o.camera=a.camera),a.scene&&(o.scene=a.scene),a.recursive&&(o.recursive=a.recursive),a.controls&&(o.controls=a.controls)}}function c(a){ThreeMice.hasEvent(a,ThreeMice.Events.MOUSEOVER)&&a.mouseover(a),o.mouse.intersected=a}function d(){o.mouse.intersected&&ThreeMice.hasEvent(o.mouse.intersected,ThreeMice.Events.MOUSEOUT)&&o.mouse.intersected.mouseout(o.mouse.intersected),o.mouse.intersected=null}function e(a){ThreeMice.hasEvent(a,ThreeMice.Events.MOUSEDOWN)&&a.mousedown(a),o.mouse.clicked=a}function f(a){o.mouse.clicked&&o.mouse.clicked===a&&(ThreeMice.hasEvent(a,ThreeMice.Events.MOUSEUP)&&a.mouseup(a),ThreeMice.hasEvent(a,ThreeMice.Events.MOUSECLICK)&&a.mouseclick(a)),o.mouse.clicked=null}function g(a){if(o.enabled&&o.enabledEvents.mousemove){k(a);var b=l();b?(ThreeMice.hasEvent(b,ThreeMice.Events.MOUSEOVER)||ThreeMice.hasEvent(b,ThreeMice.Events.MOUSEOUT))&&b!==o.mouse.intersected&&(d(),c(b)):d()}}function h(a){o.enabled&&o.enabledEvents.mousemove&&d()}function i(a){if(o.enabled&&o.enabledEvents.mousedown){k(a);var b=l();e(b)}}function j(a){if(o.enabled&&o.enabledEvents.mousedown){k(a);var b=l();f(b)}}function k(a){var b=0,c=0;a.pageX?(b=a.pageX,c=a.pageY):a.touches?(b=a.touches[0].pageX,c=a.touches[0].pageY):a.screenX&&(b=a.screenX,c=a.screenY),o.mouse.position.x=(b-o.offset.left+document.body.scrollLeft)/o.size.width*2-1,o.mouse.position.y=2*-((c-o.offset.top+document.body.scrollTop)/o.size.height)+1}function l(){var a=null,b=new THREE.Vector3(o.mouse.position.x,o.mouse.position.y,1);b.unproject(o.camera);var c=new THREE.Raycaster(o.positionObject.position,b.sub(o.positionObject.position).normalize()),d=c.intersectObjects(o.scene.children,o.recursive);return d.length>0&&(a=d[0].object),a}function m(){o.container&&(o.container.addEventListener("mousemove",g,!1),o.container.addEventListener("mouseout",h,!1),o.container.addEventListener("mousedown",i,!1),o.container.addEventListener("mouseup",j,!1),o.container.addEventListener("touchstart",i,!1),o.container.addEventListener("touchend",j,!1))}function n(a){b(a),o.container&&o.camera&&o.scene?(o.positionObject=o.camera,o.controls&&(o.positionObject=o.controls.getObject()),m()):(o.enabled=!1,o.container||ThreeMice.log("Renderer was not defined or is not appended to DOM."),o.camera||ThreeMice.log("Camera was not defined."),o.scene||ThreeMice.log("Scene was not defined."))}var o=this;this.container=null,this.offset={top:0,left:0},this.size={width:0,height:0},this.renderer=null,this.camera=null,this.controls=null,this.positionObject=null,this.scene=null,this.recursive=!1,this.mouse={position:{x:-1,y:-1},intersected:null,clicked:null},this.enabled=!0,this.enabledEvents={mousemove:!1,mousedown:!1},this.resetSize=function(){o.container&&(o.offset=o.container.getBoundingClientRect()),o.renderer&&(o.size=o.renderer.getSize())},this.set=function(a){return a.on=function(b,c){a[b]=c,b===ThreeMice.Events.MOUSEOVER||b===ThreeMice.Events.MOUSEOUT?o.enabledEvents.mousemove=!0:b!==ThreeMice.Events.MOUSEDOWN&&b!==ThreeMice.Events.MOUSEUP&&b!==ThreeMice.Events.MOUSECLICK||(o.enabledEvents.mousedown=!0)},a},n(a)};